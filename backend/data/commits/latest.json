{
  "id": "commit_ca0db2d8_1756933502",
  "timestamp": "2025-09-04T02:35:02.355645+05:30",
  "commit_hash": "ca0db2d838f19cf93c487fd21dbd85fbc16d8bd6",
  "author": "arpit529srivastava",
  "email": "arpitsrivastava529@gmail.com",
  "message": "added infra vul\n\nSigned-off-by: arpit529srivastava \u003carpitsrivastava529@gmail.com\u003e\n",
  "files_changed": [
    "backend/data/commits/latest.json",
    "shadow-infra.tf"
  ],
  "additions": 277,
  "deletions": 33,
  "file_diffs": [
    {
      "file_name": "backend/data/commits/latest.json",
      "status": "M",
      "additions": 9,
      "deletions": 33,
      "diff": "diff --git a/backend/data/commits/latest.json b/backend/data/commits/latest.json\nindex ce71c4c..4ab93e5 100644\n--- a/backend/data/commits/latest.json\n+++ b/backend/data/commits/latest.json\n@@ -1,47 +1,23 @@\n {\n-  \"id\": \"commit_609254d4_1756933046\",\n-  \"timestamp\": \"2025-09-04T02:27:26.479257+05:30\",\n-  \"commit_hash\": \"609254d4b93e732e0ee4d960ab59faa0fac5bfdb\",\n+  \"id\": \"commit_5a78aa75_1756933367\",\n+  \"timestamp\": \"2025-09-04T02:32:47.659037+05:30\",\n+  \"commit_hash\": \"5a78aa7507b365502fee7f11664af08621537cec\",\n   \"author\": \"arpit529srivastava\",\n   \"email\": \"arpitsrivastava529@gmail.com\",\n-  \"message\": \"checking\\n\\nSigned-off-by: arpit529srivastava \\u003carpitsrivastava529@gmail.com\\u003e\\n\",\n+  \"message\": \"checking456\\n\\nSigned-off-by: arpit529srivastava \\u003carpitsrivastava529@gmail.com\\u003e\\n\",\n   \"files_changed\": [\n-    \"backend/bin/threat-modeler\",\n-    \"backend/internal/handlers/commit_analysis.go\",\n-    \"backend/internal/models/models.go\",\n     \"hello.cpp\"\n   ],\n-  \"additions\": 34,\n-  \"deletions\": 2,\n+  \"additions\": 3,\n+  \"deletions\": 0,\n   \"file_diffs\": [\n-    {\n-      \"file_name\": \"backend/bin/threat-modeler\",\n-      \"status\": \"M\",\n-      \"additions\": 0,\n-      \"deletions\": 0,\n-      \"diff\": \"diff --git a/backend/bin/threat-modeler b/backend/bin/threat-modeler\\nindex 7d1690e..37c5fdd 100755\\nBinary files a/backend/bin/threat-modeler and b/backend/bin/threat-modeler differ\\n\"\n-    },\n-    {\n-      \"file_name\": \"backend/internal/handlers/commit_analysis.go\",\n-      \"status\": \"M\",\n-      \"additions\": 15,\n-      \"deletions\": 2,\n-      \"diff\": \"diff --git a/backend/internal/handlers/commit_analysis.go b/backend/internal/handlers/commit_analysis.go\\nindex 0dfa311..7920b16 100644\\n--- a/backend/internal/handlers/commit_analysis.go\\n+++ b/backend/internal/handlers/commit_analysis.go\\n@@ -14,11 +14,11 @@ var commitStorage *services.CommitStorageService\\n // InitializeCommitStorage initializes the commit storage service\\n func InitializeCommitStorage(storagePath string) {\\n \\tcommitStorage = services.NewCommitStorageService(storagePath)\\n }\\n \\n-// GetLatestCommitAnalysis returns the most recent commit analysis data\\n+// GetLatestCommitAnalysis returns the most recent commit analysis data (simplified version)\\n func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\tif commitStorage == nil {\\n \\t\\treturn c.Status(500).JSON(fiber.Map{\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": \\\"Commit storage not initialized\\\",\\n@@ -31,13 +31,26 @@ func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": err.Error(),\\n \\t\\t})\\n \\t}\\n \\n+\\t// Convert to simplified version without file diffs and full diff\\n+\\tsimplifiedData := \\u0026models.SimplifiedCommitData{\\n+\\t\\tID:           analysis.ID,\\n+\\t\\tTimestamp:    analysis.Timestamp,\\n+\\t\\tCommitHash:   analysis.CommitHash,\\n+\\t\\tAuthor:       analysis.Author,\\n+\\t\\tEmail:        analysis.Email,\\n+\\t\\tMessage:      analysis.Message,\\n+\\t\\tAdditions:    analysis.Additions,\\n+\\t\\tDeletions:    analysis.Deletions,\\n+\\t\\tFilesChanged: analysis.FilesChanged,\\n+\\t}\\n+\\n \\treturn c.JSON(fiber.Map{\\n \\t\\t\\\"success\\\": true,\\n-\\t\\t\\\"data\\\":    analysis,\\n+\\t\\t\\\"data\\\":    simplifiedData,\\n \\t})\\n }\\n \\n // GetCommitAnalysisByHash returns commit analysis data for a specific commit hash\\n func GetCommitAnalysisByHash(c *fiber.Ctx) error {\\n\"\n-    },\n-    {\n-      \"file_name\": \"backend/internal/models/models.go\",\n-      \"status\": \"M\",\n-      \"additions\": 13,\n-      \"deletions\": 0,\n-      \"diff\": \"diff --git a/backend/internal/models/models.go b/backend/internal/models/models.go\\nindex 19bb831..db42a8c 100644\\n--- a/backend/internal/models/models.go\\n+++ b/backend/internal/models/models.go\\n@@ -167,5 +167,18 @@ type FileDiff struct {\\n \\tAdditions   int    `json:\\\"additions\\\"`\\n \\tDeletions   int    `json:\\\"deletions\\\"`\\n \\tOldFileName string `json:\\\"old_file_name,omitempty\\\"` // For renamed files\\n \\tDiff        string `json:\\\"diff\\\"`                    // The actual diff content for this file\\n }\\n+\\n+// SimplifiedCommitData represents a simplified version of commit data without detailed diffs\\n+type SimplifiedCommitData struct {\\n+\\tID           string    `json:\\\"id\\\"`\\n+\\tTimestamp    time.Time `json:\\\"timestamp\\\"`\\n+\\tCommitHash   string    `json:\\\"commit_hash\\\"`\\n+\\tAuthor       string    `json:\\\"author\\\"`\\n+\\tEmail        string    `json:\\\"email\\\"`\\n+\\tMessage      string    `json:\\\"message\\\"`\\n+\\tAdditions    int       `json:\\\"additions\\\"`\\n+\\tDeletions    int       `json:\\\"deletions\\\"`\\n+\\tFilesChanged []string  `json:\\\"files_changed\\\"`\\n+}\\n\"\n-    },\n     {\n       \"file_name\": \"hello.cpp\",\n       \"status\": \"M\",\n-      \"additions\": 6,\n+      \"additions\": 3,\n       \"deletions\": 0,\n-      \"diff\": \"diff --git a/hello.cpp b/hello.cpp\\nindex e69de29..f253cbe 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -0,0 +1,6 @@\\n+#include \\u003ciostream\\u003e\\n+\\n+int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    return 0;\\n+}\\n\\\\ No newline at end of file\\n\"\n+      \"diff\": \"diff --git a/hello.cpp b/hello.cpp\\nindex 9df8bf2..7a4f2c8 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -1,8 +1,11 @@\\n #include \\u003ciostream\\u003e\\n \\n int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     return 0;\\n\"\n     }\n   ],\n-  \"full_diff\": \" backend/bin/threat-modeler                   | Bin 15142242 -\\u003e 15142354 bytes\\n backend/internal/handlers/commit_analysis.go |  17 +++++++++++++++--\\n backend/internal/models/models.go            |  13 +++++++++++++\\n hello.cpp                                    |   6 ++++++\\n 4 files changed, 34 insertions(+), 2 deletions(-)\\n\\ndiff --git a/backend/bin/threat-modeler b/backend/bin/threat-modeler\\nindex 7d1690ed9f27f92e99c9944da1aa308b2950f128..37c5fdde69af1f96ea7fe0cc674bd7fe0936704a 100755\\nBinary files a/backend/bin/threat-modeler and b/backend/bin/threat-modeler differ\\ndiff --git a/backend/internal/handlers/commit_analysis.go b/backend/internal/handlers/commit_analysis.go\\nindex 0dfa311588ac1f7b8e7250d8c715ffa55ccbb5af..7920b1653c52c4ea1f7acae5fee8a885fc2ac0bf 100644\\n--- a/backend/internal/handlers/commit_analysis.go\\n+++ b/backend/internal/handlers/commit_analysis.go\\n@@ -14,11 +14,11 @@ var commitStorage *services.CommitStorageService\\n // InitializeCommitStorage initializes the commit storage service\\n func InitializeCommitStorage(storagePath string) {\\n \\tcommitStorage = services.NewCommitStorageService(storagePath)\\n }\\n \\n-// GetLatestCommitAnalysis returns the most recent commit analysis data\\n+// GetLatestCommitAnalysis returns the most recent commit analysis data (simplified version)\\n func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\tif commitStorage == nil {\\n \\t\\treturn c.Status(500).JSON(fiber.Map{\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": \\\"Commit storage not initialized\\\",\\n@@ -31,13 +31,26 @@ func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": err.Error(),\\n \\t\\t})\\n \\t}\\n \\n+\\t// Convert to simplified version without file diffs and full diff\\n+\\tsimplifiedData := \\u0026models.SimplifiedCommitData{\\n+\\t\\tID:           analysis.ID,\\n+\\t\\tTimestamp:    analysis.Timestamp,\\n+\\t\\tCommitHash:   analysis.CommitHash,\\n+\\t\\tAuthor:       analysis.Author,\\n+\\t\\tEmail:        analysis.Email,\\n+\\t\\tMessage:      analysis.Message,\\n+\\t\\tAdditions:    analysis.Additions,\\n+\\t\\tDeletions:    analysis.Deletions,\\n+\\t\\tFilesChanged: analysis.FilesChanged,\\n+\\t}\\n+\\n \\treturn c.JSON(fiber.Map{\\n \\t\\t\\\"success\\\": true,\\n-\\t\\t\\\"data\\\":    analysis,\\n+\\t\\t\\\"data\\\":    simplifiedData,\\n \\t})\\n }\\n \\n // GetCommitAnalysisByHash returns commit analysis data for a specific commit hash\\n func GetCommitAnalysisByHash(c *fiber.Ctx) error {\\ndiff --git a/backend/internal/models/models.go b/backend/internal/models/models.go\\nindex 19bb831762ea26168167562af8532b9f5d25f56f..db42a8c246daffc5a1ace6ce1b1b5013c9a34e49 100644\\n--- a/backend/internal/models/models.go\\n+++ b/backend/internal/models/models.go\\n@@ -167,5 +167,18 @@ type FileDiff struct {\\n \\tAdditions   int    `json:\\\"additions\\\"`\\n \\tDeletions   int    `json:\\\"deletions\\\"`\\n \\tOldFileName string `json:\\\"old_file_name,omitempty\\\"` // For renamed files\\n \\tDiff        string `json:\\\"diff\\\"`                    // The actual diff content for this file\\n }\\n+\\n+// SimplifiedCommitData represents a simplified version of commit data without detailed diffs\\n+type SimplifiedCommitData struct {\\n+\\tID           string    `json:\\\"id\\\"`\\n+\\tTimestamp    time.Time `json:\\\"timestamp\\\"`\\n+\\tCommitHash   string    `json:\\\"commit_hash\\\"`\\n+\\tAuthor       string    `json:\\\"author\\\"`\\n+\\tEmail        string    `json:\\\"email\\\"`\\n+\\tMessage      string    `json:\\\"message\\\"`\\n+\\tAdditions    int       `json:\\\"additions\\\"`\\n+\\tDeletions    int       `json:\\\"deletions\\\"`\\n+\\tFilesChanged []string  `json:\\\"files_changed\\\"`\\n+}\\ndiff --git a/hello.cpp b/hello.cpp\\nindex e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..f253cbe41afe163bb3d9777d37984aec781aaeff 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -0,0 +1,6 @@\\n+#include \\u003ciostream\\u003e\\n+\\n+int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    return 0;\\n+}\\n\\\\ No newline at end of file\\n\"\n+  \"full_diff\": \" hello.cpp | 3 +++\\n 1 file changed, 3 insertions(+)\\n\\ndiff --git a/hello.cpp b/hello.cpp\\nindex 9df8bf222eafa46e28a1461ca9007737bbce80cf..7a4f2c8d071dccef75ef7ff3c131a07d87ba4872 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -1,8 +1,11 @@\\n #include \\u003ciostream\\u003e\\n \\n int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     return 0;\\n\"\n }\n\\ No newline at end of file\n"
    },
    {
      "file_name": "shadow-infra.tf",
      "status": "A",
      "additions": 268,
      "deletions": 0,
      "diff": "diff --git a/shadow-infra.tf b/shadow-infra.tf\nnew file mode 100644\nindex 0000000..e127633\n--- /dev/null\n+++ b/shadow-infra.tf\n@@ -0,0 +1,268 @@\n+# VULNERABILITY: Shadow Infrastructure\n+# This Terraform file provisions infrastructure outside of standard pipelines\n+# INTENTIONALLY INSECURE FOR DEMO - Do not use in production!\n+\n+terraform {\n+  required_version = \"\u003e= 0.12\"\n+  \n+  # VULNERABLE: No backend configuration\n+  # VULNERABLE: No state management\n+  # VULNERABLE: No remote state storage\n+  # VULNERABLE: No state locking\n+}\n+\n+# VULNERABLE: No provider configuration\n+# VULNERABLE: No region specification\n+# VULNERABLE: No credentials management\n+\n+# VULNERABLE: Shadow VPC - not tracked in main infrastructure\n+resource \"aws_vpc\" \"shadow_vpc\" {\n+  cidr_block = \"10.0.0.0/16\"\n+  \n+  # VULNERABLE: No tags for tracking\n+  # VULNERABLE: No cost allocation tags\n+  # VULNERABLE: No security tags\n+  \n+  enable_dns_hostnames = true\n+  enable_dns_support   = true\n+}\n+\n+# VULNERABLE: Shadow subnet with public access\n+resource \"aws_subnet\" \"shadow_public_subnet\" {\n+  vpc_id            = aws_vpc.shadow_vpc.id\n+  cidr_block        = \"10.0.1.0/24\"\n+  availability_zone = \"us-east-1a\"\n+  \n+  # VULNERABLE: Public subnet with auto-assign public IPs\n+  map_public_ip_on_launch = true\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Internet gateway for public access\n+resource \"aws_internet_gateway\" \"shadow_igw\" {\n+  vpc_id = aws_vpc.shadow_vpc.id\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Route table with public internet access\n+resource \"aws_route_table\" \"shadow_public_rt\" {\n+  vpc_id = aws_vpc.shadow_vpc.id\n+\n+  route {\n+    cidr_block = \"0.0.0.0/0\"\n+    gateway_id = aws_internet_gateway.shadow_igw.id\n+  }\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Route table association\n+resource \"aws_route_table_association\" \"shadow_public_rta\" {\n+  subnet_id      = aws_subnet.shadow_public_subnet.id\n+  route_table_id = aws_route_table.shadow_public_rt.id\n+}\n+\n+# VULNERABLE: Overly permissive security group\n+resource \"aws_security_group\" \"shadow_sg\" {\n+  name        = \"shadow-security-group\"\n+  description = \"Shadow infrastructure security group\"\n+  vpc_id      = aws_vpc.shadow_vpc.id\n+\n+  # VULNERABLE: SSH access from anywhere\n+  ingress {\n+    description = \"SSH from anywhere\"\n+    from_port   = 22\n+    to_port     = 22\n+    protocol    = \"tcp\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows access from anywhere\n+  }\n+\n+  # VULNERABLE: HTTP access from anywhere\n+  ingress {\n+    description = \"HTTP from anywhere\"\n+    from_port   = 80\n+    to_port     = 80\n+    protocol    = \"tcp\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows access from anywhere\n+  }\n+\n+  # VULNERABLE: HTTPS access from anywhere\n+  ingress {\n+    description = \"HTTPS from anywhere\"\n+    from_port   = 443\n+    to_port     = 443\n+    protocol    = \"tcp\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows access from anywhere\n+  }\n+\n+  # VULNERABLE: All outbound traffic allowed\n+  egress {\n+    description = \"All outbound traffic\"\n+    from_port   = 0\n+    to_port     = 0\n+    protocol    = \"-1\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows all outbound traffic\n+  }\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Shadow EC2 instance with public IP\n+resource \"aws_instance\" \"shadow_instance\" {\n+  ami           = \"ami-12345678\"  # VULNERABLE: Hardcoded AMI\n+  instance_type = \"t3.medium\"\n+  \n+  # VULNERABLE: Public IP address\n+  associate_public_ip_address = true\n+  \n+  # VULNERABLE: Subnet in public subnet\n+  subnet_id = aws_subnet.shadow_public_subnet.id\n+  \n+  # VULNERABLE: Overly permissive security group\n+  vpc_security_group_ids = [aws_security_group.shadow_sg.id]\n+  \n+  # VULNERABLE: No key pair for SSH access\n+  # VULNERABLE: No user data for secure configuration\n+  \n+  # VULNERABLE: Root volume configuration\n+  root_block_device {\n+    volume_type = \"gp3\"\n+    volume_size = 20\n+    encrypted   = false  # VULNERABLE: No encryption\n+  }\n+  \n+  # VULNERABLE: No tags for tracking\n+  # VULNERABLE: No cost allocation tags\n+  # VULNERABLE: No security tags\n+}\n+\n+# VULNERABLE: Shadow RDS instance\n+resource \"aws_db_instance\" \"shadow_db\" {\n+  identifier = \"shadow-database\"\n+  \n+  # VULNERABLE: Publicly accessible database\n+  publicly_accessible = true\n+  \n+  # VULNERABLE: Weak database configuration\n+  engine               = \"mysql\"\n+  engine_version       = \"5.7\"\n+  instance_class       = \"db.t3.micro\"\n+  allocated_storage    = 20\n+  storage_type         = \"gp2\"\n+  storage_encrypted    = false  # VULNERABLE: No encryption\n+  \n+  # VULNERABLE: Weak credentials\n+  username = \"admin\"\n+  password = \"password123\"  # VULNERABLE: Hardcoded password\n+  \n+  # VULNERABLE: No backup configuration\n+  backup_retention_period = 0\n+  backup_window          = \"\"\n+  maintenance_window     = \"\"\n+  \n+  # VULNERABLE: No deletion protection\n+  deletion_protection = false\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Shadow S3 bucket\n+resource \"aws_s3_bucket\" \"shadow_bucket\" {\n+  bucket = \"shadow-data-bucket-12345\"\n+  \n+  # VULNERABLE: No encryption\n+  # VULNERABLE: No versioning\n+  # VULNERABLE: No lifecycle policy\n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Public S3 bucket policy\n+resource \"aws_s3_bucket_policy\" \"shadow_bucket_policy\" {\n+  bucket = aws_s3_bucket.shadow_bucket.id\n+\n+  policy = jsonencode({\n+    Version = \"2012-10-17\"\n+    Statement = [\n+      {\n+        Sid       = \"PublicReadWrite\"\n+        Effect    = \"Allow\"\n+        Principal = \"*\"  # VULNERABLE: Allows any principal\n+        Action    = [\n+          \"s3:GetObject\",\n+          \"s3:PutObject\",\n+          \"s3:DeleteObject\"\n+        ]\n+        Resource = \"${aws_s3_bucket.shadow_bucket.arn}/*\"\n+      },\n+    ]\n+  })\n+}\n+\n+# VULNERABLE: Shadow IAM role with excessive permissions\n+resource \"aws_iam_role\" \"shadow_role\" {\n+  name = \"shadow-instance-role\"\n+\n+  assume_role_policy = jsonencode({\n+    Version = \"2012-10-17\"\n+    Statement = [\n+      {\n+        Action = \"sts:AssumeRole\"\n+        Effect = \"Allow\"\n+        Principal = {\n+          Service = \"ec2.amazonaws.com\"\n+        }\n+      },\n+    ]\n+  })\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Overly permissive IAM policy\n+resource \"aws_iam_role_policy\" \"shadow_policy\" {\n+  name = \"shadow-instance-policy\"\n+  role = aws_iam_role.shadow_role.id\n+\n+  policy = jsonencode({\n+    Version = \"2012-10-17\"\n+    Statement = [\n+      {\n+        Effect = \"Allow\"\n+        Action = \"*\"  # VULNERABLE: All actions allowed\n+        Resource = \"*\"  # VULNERABLE: All resources allowed\n+      }\n+    ]\n+  })\n+}\n+\n+# VULNERABLE: Instance profile with excessive permissions\n+resource \"aws_iam_instance_profile\" \"shadow_profile\" {\n+  name = \"shadow-instance-profile\"\n+  role = aws_iam_role.shadow_role.name\n+}\n+\n+# VULNERABLE: Output sensitive information\n+output \"shadow_instance_public_ip\" {\n+  value = aws_instance.shadow_instance.public_ip\n+  # VULNERABLE: Exposing public IP\n+}\n+\n+output \"shadow_db_endpoint\" {\n+  value = aws_db_instance.shadow_db.endpoint\n+  # VULNERABLE: Exposing database endpoint\n+}\n+\n+output \"shadow_bucket_name\" {\n+  value = aws_s3_bucket.shadow_bucket.bucket\n+  # VULNERABLE: Exposing bucket name\n+}\n+\n+# VULNERABLE: No monitoring or alerting\n+# VULNERABLE: No logging configuration\n+# VULNERABLE: No backup strategy\n+# VULNERABLE: No disaster recovery plan\n+# VULNERABLE: No compliance controls\n+# VULNERABLE: No security scanning\n+# VULNERABLE: No vulnerability assessment\n"
    }
  ],
  "full_diff": " backend/data/commits/latest.json |  42 ++----\n shadow-infra.tf                  | 268 +++++++++++++++++++++++++++++++++++++++\n 2 files changed, 277 insertions(+), 33 deletions(-)\n\ndiff --git a/backend/data/commits/latest.json b/backend/data/commits/latest.json\nindex ce71c4c7e00dc8c72cd6595f7f53c1cafa4f59bc..4ab93e5114a95543e14610f1f2ddd8eaf220dc04 100644\n--- a/backend/data/commits/latest.json\n+++ b/backend/data/commits/latest.json\n@@ -1,47 +1,23 @@\n {\n-  \"id\": \"commit_609254d4_1756933046\",\n-  \"timestamp\": \"2025-09-04T02:27:26.479257+05:30\",\n-  \"commit_hash\": \"609254d4b93e732e0ee4d960ab59faa0fac5bfdb\",\n+  \"id\": \"commit_5a78aa75_1756933367\",\n+  \"timestamp\": \"2025-09-04T02:32:47.659037+05:30\",\n+  \"commit_hash\": \"5a78aa7507b365502fee7f11664af08621537cec\",\n   \"author\": \"arpit529srivastava\",\n   \"email\": \"arpitsrivastava529@gmail.com\",\n-  \"message\": \"checking\\n\\nSigned-off-by: arpit529srivastava \\u003carpitsrivastava529@gmail.com\\u003e\\n\",\n+  \"message\": \"checking456\\n\\nSigned-off-by: arpit529srivastava \\u003carpitsrivastava529@gmail.com\\u003e\\n\",\n   \"files_changed\": [\n-    \"backend/bin/threat-modeler\",\n-    \"backend/internal/handlers/commit_analysis.go\",\n-    \"backend/internal/models/models.go\",\n     \"hello.cpp\"\n   ],\n-  \"additions\": 34,\n-  \"deletions\": 2,\n+  \"additions\": 3,\n+  \"deletions\": 0,\n   \"file_diffs\": [\n-    {\n-      \"file_name\": \"backend/bin/threat-modeler\",\n-      \"status\": \"M\",\n-      \"additions\": 0,\n-      \"deletions\": 0,\n-      \"diff\": \"diff --git a/backend/bin/threat-modeler b/backend/bin/threat-modeler\\nindex 7d1690e..37c5fdd 100755\\nBinary files a/backend/bin/threat-modeler and b/backend/bin/threat-modeler differ\\n\"\n-    },\n-    {\n-      \"file_name\": \"backend/internal/handlers/commit_analysis.go\",\n-      \"status\": \"M\",\n-      \"additions\": 15,\n-      \"deletions\": 2,\n-      \"diff\": \"diff --git a/backend/internal/handlers/commit_analysis.go b/backend/internal/handlers/commit_analysis.go\\nindex 0dfa311..7920b16 100644\\n--- a/backend/internal/handlers/commit_analysis.go\\n+++ b/backend/internal/handlers/commit_analysis.go\\n@@ -14,11 +14,11 @@ var commitStorage *services.CommitStorageService\\n // InitializeCommitStorage initializes the commit storage service\\n func InitializeCommitStorage(storagePath string) {\\n \\tcommitStorage = services.NewCommitStorageService(storagePath)\\n }\\n \\n-// GetLatestCommitAnalysis returns the most recent commit analysis data\\n+// GetLatestCommitAnalysis returns the most recent commit analysis data (simplified version)\\n func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\tif commitStorage == nil {\\n \\t\\treturn c.Status(500).JSON(fiber.Map{\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": \\\"Commit storage not initialized\\\",\\n@@ -31,13 +31,26 @@ func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": err.Error(),\\n \\t\\t})\\n \\t}\\n \\n+\\t// Convert to simplified version without file diffs and full diff\\n+\\tsimplifiedData := \\u0026models.SimplifiedCommitData{\\n+\\t\\tID:           analysis.ID,\\n+\\t\\tTimestamp:    analysis.Timestamp,\\n+\\t\\tCommitHash:   analysis.CommitHash,\\n+\\t\\tAuthor:       analysis.Author,\\n+\\t\\tEmail:        analysis.Email,\\n+\\t\\tMessage:      analysis.Message,\\n+\\t\\tAdditions:    analysis.Additions,\\n+\\t\\tDeletions:    analysis.Deletions,\\n+\\t\\tFilesChanged: analysis.FilesChanged,\\n+\\t}\\n+\\n \\treturn c.JSON(fiber.Map{\\n \\t\\t\\\"success\\\": true,\\n-\\t\\t\\\"data\\\":    analysis,\\n+\\t\\t\\\"data\\\":    simplifiedData,\\n \\t})\\n }\\n \\n // GetCommitAnalysisByHash returns commit analysis data for a specific commit hash\\n func GetCommitAnalysisByHash(c *fiber.Ctx) error {\\n\"\n-    },\n-    {\n-      \"file_name\": \"backend/internal/models/models.go\",\n-      \"status\": \"M\",\n-      \"additions\": 13,\n-      \"deletions\": 0,\n-      \"diff\": \"diff --git a/backend/internal/models/models.go b/backend/internal/models/models.go\\nindex 19bb831..db42a8c 100644\\n--- a/backend/internal/models/models.go\\n+++ b/backend/internal/models/models.go\\n@@ -167,5 +167,18 @@ type FileDiff struct {\\n \\tAdditions   int    `json:\\\"additions\\\"`\\n \\tDeletions   int    `json:\\\"deletions\\\"`\\n \\tOldFileName string `json:\\\"old_file_name,omitempty\\\"` // For renamed files\\n \\tDiff        string `json:\\\"diff\\\"`                    // The actual diff content for this file\\n }\\n+\\n+// SimplifiedCommitData represents a simplified version of commit data without detailed diffs\\n+type SimplifiedCommitData struct {\\n+\\tID           string    `json:\\\"id\\\"`\\n+\\tTimestamp    time.Time `json:\\\"timestamp\\\"`\\n+\\tCommitHash   string    `json:\\\"commit_hash\\\"`\\n+\\tAuthor       string    `json:\\\"author\\\"`\\n+\\tEmail        string    `json:\\\"email\\\"`\\n+\\tMessage      string    `json:\\\"message\\\"`\\n+\\tAdditions    int       `json:\\\"additions\\\"`\\n+\\tDeletions    int       `json:\\\"deletions\\\"`\\n+\\tFilesChanged []string  `json:\\\"files_changed\\\"`\\n+}\\n\"\n-    },\n     {\n       \"file_name\": \"hello.cpp\",\n       \"status\": \"M\",\n-      \"additions\": 6,\n+      \"additions\": 3,\n       \"deletions\": 0,\n-      \"diff\": \"diff --git a/hello.cpp b/hello.cpp\\nindex e69de29..f253cbe 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -0,0 +1,6 @@\\n+#include \\u003ciostream\\u003e\\n+\\n+int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    return 0;\\n+}\\n\\\\ No newline at end of file\\n\"\n+      \"diff\": \"diff --git a/hello.cpp b/hello.cpp\\nindex 9df8bf2..7a4f2c8 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -1,8 +1,11 @@\\n #include \\u003ciostream\\u003e\\n \\n int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     return 0;\\n\"\n     }\n   ],\n-  \"full_diff\": \" backend/bin/threat-modeler                   | Bin 15142242 -\\u003e 15142354 bytes\\n backend/internal/handlers/commit_analysis.go |  17 +++++++++++++++--\\n backend/internal/models/models.go            |  13 +++++++++++++\\n hello.cpp                                    |   6 ++++++\\n 4 files changed, 34 insertions(+), 2 deletions(-)\\n\\ndiff --git a/backend/bin/threat-modeler b/backend/bin/threat-modeler\\nindex 7d1690ed9f27f92e99c9944da1aa308b2950f128..37c5fdde69af1f96ea7fe0cc674bd7fe0936704a 100755\\nBinary files a/backend/bin/threat-modeler and b/backend/bin/threat-modeler differ\\ndiff --git a/backend/internal/handlers/commit_analysis.go b/backend/internal/handlers/commit_analysis.go\\nindex 0dfa311588ac1f7b8e7250d8c715ffa55ccbb5af..7920b1653c52c4ea1f7acae5fee8a885fc2ac0bf 100644\\n--- a/backend/internal/handlers/commit_analysis.go\\n+++ b/backend/internal/handlers/commit_analysis.go\\n@@ -14,11 +14,11 @@ var commitStorage *services.CommitStorageService\\n // InitializeCommitStorage initializes the commit storage service\\n func InitializeCommitStorage(storagePath string) {\\n \\tcommitStorage = services.NewCommitStorageService(storagePath)\\n }\\n \\n-// GetLatestCommitAnalysis returns the most recent commit analysis data\\n+// GetLatestCommitAnalysis returns the most recent commit analysis data (simplified version)\\n func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\tif commitStorage == nil {\\n \\t\\treturn c.Status(500).JSON(fiber.Map{\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": \\\"Commit storage not initialized\\\",\\n@@ -31,13 +31,26 @@ func GetLatestCommitAnalysis(c *fiber.Ctx) error {\\n \\t\\t\\t\\\"error\\\":   true,\\n \\t\\t\\t\\\"message\\\": err.Error(),\\n \\t\\t})\\n \\t}\\n \\n+\\t// Convert to simplified version without file diffs and full diff\\n+\\tsimplifiedData := \\u0026models.SimplifiedCommitData{\\n+\\t\\tID:           analysis.ID,\\n+\\t\\tTimestamp:    analysis.Timestamp,\\n+\\t\\tCommitHash:   analysis.CommitHash,\\n+\\t\\tAuthor:       analysis.Author,\\n+\\t\\tEmail:        analysis.Email,\\n+\\t\\tMessage:      analysis.Message,\\n+\\t\\tAdditions:    analysis.Additions,\\n+\\t\\tDeletions:    analysis.Deletions,\\n+\\t\\tFilesChanged: analysis.FilesChanged,\\n+\\t}\\n+\\n \\treturn c.JSON(fiber.Map{\\n \\t\\t\\\"success\\\": true,\\n-\\t\\t\\\"data\\\":    analysis,\\n+\\t\\t\\\"data\\\":    simplifiedData,\\n \\t})\\n }\\n \\n // GetCommitAnalysisByHash returns commit analysis data for a specific commit hash\\n func GetCommitAnalysisByHash(c *fiber.Ctx) error {\\ndiff --git a/backend/internal/models/models.go b/backend/internal/models/models.go\\nindex 19bb831762ea26168167562af8532b9f5d25f56f..db42a8c246daffc5a1ace6ce1b1b5013c9a34e49 100644\\n--- a/backend/internal/models/models.go\\n+++ b/backend/internal/models/models.go\\n@@ -167,5 +167,18 @@ type FileDiff struct {\\n \\tAdditions   int    `json:\\\"additions\\\"`\\n \\tDeletions   int    `json:\\\"deletions\\\"`\\n \\tOldFileName string `json:\\\"old_file_name,omitempty\\\"` // For renamed files\\n \\tDiff        string `json:\\\"diff\\\"`                    // The actual diff content for this file\\n }\\n+\\n+// SimplifiedCommitData represents a simplified version of commit data without detailed diffs\\n+type SimplifiedCommitData struct {\\n+\\tID           string    `json:\\\"id\\\"`\\n+\\tTimestamp    time.Time `json:\\\"timestamp\\\"`\\n+\\tCommitHash   string    `json:\\\"commit_hash\\\"`\\n+\\tAuthor       string    `json:\\\"author\\\"`\\n+\\tEmail        string    `json:\\\"email\\\"`\\n+\\tMessage      string    `json:\\\"message\\\"`\\n+\\tAdditions    int       `json:\\\"additions\\\"`\\n+\\tDeletions    int       `json:\\\"deletions\\\"`\\n+\\tFilesChanged []string  `json:\\\"files_changed\\\"`\\n+}\\ndiff --git a/hello.cpp b/hello.cpp\\nindex e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..f253cbe41afe163bb3d9777d37984aec781aaeff 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -0,0 +1,6 @@\\n+#include \\u003ciostream\\u003e\\n+\\n+int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    return 0;\\n+}\\n\\\\ No newline at end of file\\n\"\n+  \"full_diff\": \" hello.cpp | 3 +++\\n 1 file changed, 3 insertions(+)\\n\\ndiff --git a/hello.cpp b/hello.cpp\\nindex 9df8bf222eafa46e28a1461ca9007737bbce80cf..7a4f2c8d071dccef75ef7ff3c131a07d87ba4872 100644\\n--- a/hello.cpp\\n+++ b/hello.cpp\\n@@ -1,8 +1,11 @@\\n #include \\u003ciostream\\u003e\\n \\n int main() {\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n+    std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     std::cout \\u003c\\u003c \\\"Hello, World!\\\" \\u003c\\u003c std::endl;\\n     return 0;\\n\"\n }\n\\ No newline at end of file\ndiff --git a/shadow-infra.tf b/shadow-infra.tf\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..e1276330e9151fe0312f806e4d4660213004c6f5\n--- /dev/null\n+++ b/shadow-infra.tf\n@@ -0,0 +1,268 @@\n+# VULNERABILITY: Shadow Infrastructure\n+# This Terraform file provisions infrastructure outside of standard pipelines\n+# INTENTIONALLY INSECURE FOR DEMO - Do not use in production!\n+\n+terraform {\n+  required_version = \"\u003e= 0.12\"\n+  \n+  # VULNERABLE: No backend configuration\n+  # VULNERABLE: No state management\n+  # VULNERABLE: No remote state storage\n+  # VULNERABLE: No state locking\n+}\n+\n+# VULNERABLE: No provider configuration\n+# VULNERABLE: No region specification\n+# VULNERABLE: No credentials management\n+\n+# VULNERABLE: Shadow VPC - not tracked in main infrastructure\n+resource \"aws_vpc\" \"shadow_vpc\" {\n+  cidr_block = \"10.0.0.0/16\"\n+  \n+  # VULNERABLE: No tags for tracking\n+  # VULNERABLE: No cost allocation tags\n+  # VULNERABLE: No security tags\n+  \n+  enable_dns_hostnames = true\n+  enable_dns_support   = true\n+}\n+\n+# VULNERABLE: Shadow subnet with public access\n+resource \"aws_subnet\" \"shadow_public_subnet\" {\n+  vpc_id            = aws_vpc.shadow_vpc.id\n+  cidr_block        = \"10.0.1.0/24\"\n+  availability_zone = \"us-east-1a\"\n+  \n+  # VULNERABLE: Public subnet with auto-assign public IPs\n+  map_public_ip_on_launch = true\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Internet gateway for public access\n+resource \"aws_internet_gateway\" \"shadow_igw\" {\n+  vpc_id = aws_vpc.shadow_vpc.id\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Route table with public internet access\n+resource \"aws_route_table\" \"shadow_public_rt\" {\n+  vpc_id = aws_vpc.shadow_vpc.id\n+\n+  route {\n+    cidr_block = \"0.0.0.0/0\"\n+    gateway_id = aws_internet_gateway.shadow_igw.id\n+  }\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Route table association\n+resource \"aws_route_table_association\" \"shadow_public_rta\" {\n+  subnet_id      = aws_subnet.shadow_public_subnet.id\n+  route_table_id = aws_route_table.shadow_public_rt.id\n+}\n+\n+# VULNERABLE: Overly permissive security group\n+resource \"aws_security_group\" \"shadow_sg\" {\n+  name        = \"shadow-security-group\"\n+  description = \"Shadow infrastructure security group\"\n+  vpc_id      = aws_vpc.shadow_vpc.id\n+\n+  # VULNERABLE: SSH access from anywhere\n+  ingress {\n+    description = \"SSH from anywhere\"\n+    from_port   = 22\n+    to_port     = 22\n+    protocol    = \"tcp\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows access from anywhere\n+  }\n+\n+  # VULNERABLE: HTTP access from anywhere\n+  ingress {\n+    description = \"HTTP from anywhere\"\n+    from_port   = 80\n+    to_port     = 80\n+    protocol    = \"tcp\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows access from anywhere\n+  }\n+\n+  # VULNERABLE: HTTPS access from anywhere\n+  ingress {\n+    description = \"HTTPS from anywhere\"\n+    from_port   = 443\n+    to_port     = 443\n+    protocol    = \"tcp\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows access from anywhere\n+  }\n+\n+  # VULNERABLE: All outbound traffic allowed\n+  egress {\n+    description = \"All outbound traffic\"\n+    from_port   = 0\n+    to_port     = 0\n+    protocol    = \"-1\"\n+    cidr_blocks = [\"0.0.0.0/0\"]  # VULNERABLE: Allows all outbound traffic\n+  }\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Shadow EC2 instance with public IP\n+resource \"aws_instance\" \"shadow_instance\" {\n+  ami           = \"ami-12345678\"  # VULNERABLE: Hardcoded AMI\n+  instance_type = \"t3.medium\"\n+  \n+  # VULNERABLE: Public IP address\n+  associate_public_ip_address = true\n+  \n+  # VULNERABLE: Subnet in public subnet\n+  subnet_id = aws_subnet.shadow_public_subnet.id\n+  \n+  # VULNERABLE: Overly permissive security group\n+  vpc_security_group_ids = [aws_security_group.shadow_sg.id]\n+  \n+  # VULNERABLE: No key pair for SSH access\n+  # VULNERABLE: No user data for secure configuration\n+  \n+  # VULNERABLE: Root volume configuration\n+  root_block_device {\n+    volume_type = \"gp3\"\n+    volume_size = 20\n+    encrypted   = false  # VULNERABLE: No encryption\n+  }\n+  \n+  # VULNERABLE: No tags for tracking\n+  # VULNERABLE: No cost allocation tags\n+  # VULNERABLE: No security tags\n+}\n+\n+# VULNERABLE: Shadow RDS instance\n+resource \"aws_db_instance\" \"shadow_db\" {\n+  identifier = \"shadow-database\"\n+  \n+  # VULNERABLE: Publicly accessible database\n+  publicly_accessible = true\n+  \n+  # VULNERABLE: Weak database configuration\n+  engine               = \"mysql\"\n+  engine_version       = \"5.7\"\n+  instance_class       = \"db.t3.micro\"\n+  allocated_storage    = 20\n+  storage_type         = \"gp2\"\n+  storage_encrypted    = false  # VULNERABLE: No encryption\n+  \n+  # VULNERABLE: Weak credentials\n+  username = \"admin\"\n+  password = \"password123\"  # VULNERABLE: Hardcoded password\n+  \n+  # VULNERABLE: No backup configuration\n+  backup_retention_period = 0\n+  backup_window          = \"\"\n+  maintenance_window     = \"\"\n+  \n+  # VULNERABLE: No deletion protection\n+  deletion_protection = false\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Shadow S3 bucket\n+resource \"aws_s3_bucket\" \"shadow_bucket\" {\n+  bucket = \"shadow-data-bucket-12345\"\n+  \n+  # VULNERABLE: No encryption\n+  # VULNERABLE: No versioning\n+  # VULNERABLE: No lifecycle policy\n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Public S3 bucket policy\n+resource \"aws_s3_bucket_policy\" \"shadow_bucket_policy\" {\n+  bucket = aws_s3_bucket.shadow_bucket.id\n+\n+  policy = jsonencode({\n+    Version = \"2012-10-17\"\n+    Statement = [\n+      {\n+        Sid       = \"PublicReadWrite\"\n+        Effect    = \"Allow\"\n+        Principal = \"*\"  # VULNERABLE: Allows any principal\n+        Action    = [\n+          \"s3:GetObject\",\n+          \"s3:PutObject\",\n+          \"s3:DeleteObject\"\n+        ]\n+        Resource = \"${aws_s3_bucket.shadow_bucket.arn}/*\"\n+      },\n+    ]\n+  })\n+}\n+\n+# VULNERABLE: Shadow IAM role with excessive permissions\n+resource \"aws_iam_role\" \"shadow_role\" {\n+  name = \"shadow-instance-role\"\n+\n+  assume_role_policy = jsonencode({\n+    Version = \"2012-10-17\"\n+    Statement = [\n+      {\n+        Action = \"sts:AssumeRole\"\n+        Effect = \"Allow\"\n+        Principal = {\n+          Service = \"ec2.amazonaws.com\"\n+        }\n+      },\n+    ]\n+  })\n+  \n+  # VULNERABLE: No tags for tracking\n+}\n+\n+# VULNERABLE: Overly permissive IAM policy\n+resource \"aws_iam_role_policy\" \"shadow_policy\" {\n+  name = \"shadow-instance-policy\"\n+  role = aws_iam_role.shadow_role.id\n+\n+  policy = jsonencode({\n+    Version = \"2012-10-17\"\n+    Statement = [\n+      {\n+        Effect = \"Allow\"\n+        Action = \"*\"  # VULNERABLE: All actions allowed\n+        Resource = \"*\"  # VULNERABLE: All resources allowed\n+      }\n+    ]\n+  })\n+}\n+\n+# VULNERABLE: Instance profile with excessive permissions\n+resource \"aws_iam_instance_profile\" \"shadow_profile\" {\n+  name = \"shadow-instance-profile\"\n+  role = aws_iam_role.shadow_role.name\n+}\n+\n+# VULNERABLE: Output sensitive information\n+output \"shadow_instance_public_ip\" {\n+  value = aws_instance.shadow_instance.public_ip\n+  # VULNERABLE: Exposing public IP\n+}\n+\n+output \"shadow_db_endpoint\" {\n+  value = aws_db_instance.shadow_db.endpoint\n+  # VULNERABLE: Exposing database endpoint\n+}\n+\n+output \"shadow_bucket_name\" {\n+  value = aws_s3_bucket.shadow_bucket.bucket\n+  # VULNERABLE: Exposing bucket name\n+}\n+\n+# VULNERABLE: No monitoring or alerting\n+# VULNERABLE: No logging configuration\n+# VULNERABLE: No backup strategy\n+# VULNERABLE: No disaster recovery plan\n+# VULNERABLE: No compliance controls\n+# VULNERABLE: No security scanning\n+# VULNERABLE: No vulnerability assessment\n"
}